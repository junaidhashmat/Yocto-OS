LCONF_VERSION = "7"

BBPATH = "${TOPDIR}"
BSPDIR := "${@os.path.abspath(os.path.dirname(d.getVar('FILE', True)) + '/../..')}"

BBFILES ?= ""
BBLAYERS = " \
  ${BSPDIR}/sources/poky/meta \
  ${BSPDIR}/sources/poky/meta-poky \
  \
  ${BSPDIR}/sources/meta-openembedded/meta-oe \
  ${BSPDIR}/sources/meta-openembedded/meta-multimedia \
  ${BSPDIR}/sources/meta-openembedded/meta-python \
  \
  ${BSPDIR}/sources/meta-freescale \
  ${BSPDIR}/sources/meta-freescale-3rdparty \
  ${BSPDIR}/sources/meta-freescale-distro \
"

BBLAYERS += "${BSPDIR}/sources/meta-browser/meta-chromium"
BBLAYERS += "${BSPDIR}/sources/meta-clang"
BBLAYERS += "${BSPDIR}/sources/meta-openembedded/meta-networking"
BBLAYERS += "${BSPDIR}/sources/meta-openembedded/meta-gnome"
BBLAYERS += "${BSPDIR}/sources/meta-openembedded/meta-filesystems"
BBLAYERS += "${BSPDIR}/sources/meta-openembedded/meta-webserver"
BBLAYERS += "${BSPDIR}/sources/meta-openembedded/meta-perl"
BBLAYERS += "${BSPDIR}/sources/meta-arm/meta-arm"
BBLAYERS += "${BSPDIR}/sources/meta-arm/meta-arm-toolchain"
BBLAYERS += "${BSPDIR}/sources/meta-virtualization"
BBLAYERS += "${BSPDIR}/sources/meta-cloud-services"
BBLAYERS += "${BSPDIR}/sources/meta-security"
BBLAYERS += "${BSPDIR}/sources/meta-qoriq/meta-qoriq-bsp"
BBLAYERS += "${BSPDIR}/sources/meta-qoriq/meta-qoriq-sdk"

# Real-time Edge Yocto Project Release layers
BBLAYERS += "${BSPDIR}/sources/meta-real-time-edge"
BBLAYERS += "${BSPDIR}/sources/meta-atheer"
#!/usr/bin/env bash
set -euo pipefail

BASE_DIR="${1:-sources}"
EXCLUDE="meta-atheer"

# Header (optional)
printf "%-35s %s\n" "LAYER" "COMMIT"
printf "%-35s %s\n" "-----" "------"

for d in "$BASE_DIR"/*; do
  name="$(basename "$d")"

  # only directories
  [ -d "$d" ] || continue

  # exclude one layer
  [ "$name" = "$EXCLUDE" ] && continue

  # must be a git repo or submodule checkout
  if [ ! -d "$d/.git" ] && [ ! -f "$d/.git" ]; then
    continue
  fi

  # get HEAD commit
  hash="$(git -C "$d" rev-parse --verify HEAD 2>/dev/null || true)"
  if [ -z "$hash" ]; then
    continue
  fi

  printf "%-35s %s\n" "$name" "$hash"
done
